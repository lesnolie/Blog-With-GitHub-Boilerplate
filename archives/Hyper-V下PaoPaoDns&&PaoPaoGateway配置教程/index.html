<!DOCTYPE HTML>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="ilxyz,LESLIE" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Galileo" />
    <link rel="alternate" type="application/rss+xml" title="不愧不忘 &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="不愧不忘 &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="/assets/main.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@300;400;600;900&display=swap"
    rel="stylesheet">
    <link rel="stylesheet" href="/assets/ExSearch/ExSearch-182e5a8868.css">
    <link rel="stylesheet" href="/assets/katex.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "/162d74ce1147680e53234484c671ad70.json"
        }
    </script>
   
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <link rel="dns-prefetch" href="//static.lesliemm.xyz" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    
<title>Hyper-V下PaoPaoDns&&PaoPaoGateway配置教程 - 不愧不忘</title>
<meta name="author" content="Leslie" />
<meta name="description" content="为什么我喜欢捣鼓网络呢？一则网络确实是日常所需，最常接触；二是我能接触到的网络技术也确实简单：理解了网络拓扑，流量走向，安装相应的软件，网上还都有教程；三则事后反馈也是即时的，成就感颇高。" />
<meta property="og:title" content="Hyper-V下PaoPaoDns&&PaoPaoGateway配置教程 - 不愧不忘" />
<meta property="og:description" content="为什么我喜欢捣鼓网络呢？一则网络确实是日常所需，最常接触；二是我能接触到的网络技术也确实简单：理解了网络拓扑，流量走向，安装相应的软件，网上还都有教程；三则事后反馈也是即时的，成就感颇高。" />
<meta property="og:site_name" content="不愧不忘" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/Hyper-V下PaoPaoDns&&PaoPaoGateway配置教程/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2024-03-16T08:00:00-00.00" />
<meta name="twitter:title" content="Hyper-V下PaoPaoDns&&PaoPaoGateway配置教程 - 不愧不忘" />
<meta name="twitter:description" content="为什么我喜欢捣鼓网络呢？一则网络确实是日常所需，最常接触；二是我能接触到的网络技术也确实简单：理解了网络拓扑，流量走向，安装相应的软件，网上还都有教程；三则事后反馈也是即时的，成就感颇高。" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<link rel="stylesheet" href="/assets/katex.min.css">
<link rel="stylesheet" href="/assets/PhotoSwipe/photoswipe.css"> 
<link rel="stylesheet" href="/assets/PhotoSwipe/default-skin/default-skin.css"> 
<script src="/assets/PhotoSwipe/photoswipe.min.js"></script> 
<script src="/assets/PhotoSwipe/photoswipe-ui-default.min.js"></script> 
<script type="application/ld+json">


</script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<link rel="stylesheet" href="/assets/katex.min.css">



    </head>
    
    <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
          <a href="/">
            <img class="avatar" src="/logo.jpg" alt="">
          </a>
          <div class="site-title">
            <a href="/"
              >不愧不忘</a
            >
          </div>
          <p class="site-description">我喜欢猫</p>
          <div class="social-container">
            <a title="Twitter" href="" target="_blank"
              ><i class="ri-twitter-line"></i></a
            ><a
              title="Weibo"
              href="https://weibo.com/2185506670/"
              target="_blank"
              ><i class="ri-weibo-line"></i></a
            ><a title="Telegram" href="https://t.me/le55lie" target="_blank"
              ><i class="ri-telegram-line"></i></a
            ><a
              title="GitHub"
              href="https://github.com/lesnolie"
              target="_blank"
              ><i class="ri-github-line"></i
            ></a>
            <a
              title="Drive"
              href="https://drive.lesliemm.xyz"
              target="_blank"
              ><i class="ri-drive-line"></i>
            </a>
            <a
              title="libdrive"
              href="https://library.lesliemm.xyz"
              target="_blank"
              ><i class="ri-hard-drive-line"></i>
            </a>

            <a href="#" target="_self" class="search-form-input ga-highlight"
              ><i class="ri-search-line"></i
            ></a>
          </div>
        </div>
            
            
        
<div class="post-detail">
    <article class="post">
        <h1 class="post-title">
            Hyper-V下PaoPaoDns&&PaoPaoGateway配置教程
        </h1>
        <div class="post-info">
            <time>
                2024-03-16
            </time>
            <span>
                Leslie
            </span>
        </div>
        <div class="post-content-wrapper">
            <div class="post-content pswp-gallery">
                <p>为什么我喜欢捣鼓网络呢？一则网络确实是日常所需，最常接触；二是我能接触到的网络技术也确实简单：理解了网络拓扑，流量走向，安装相应的软件，网上还都有教程；三则事后反馈也是即时的，成就感颇高。</p>
<p>最近觉得openwrt的Homeproxy不好用。我都学会了写sing-box的配置文件，却对Homeproxy束手无策。Onedrive和canva竟然都访问不了，dns还时常出岔子。于是在网上冲浪的过程中邂逅了一篇文章，文章本身介绍利用singbox和mosdns进行分流，mosdns发现国内dns就直接直连，国外dns则通过singbox的fakeip模式进行代理。效果很好，速度很快。本人搭建成功以后，谷歌网盘的下载速度能达到40mb/s。</p>
<p>不过我一直记得作者说的一句话：</p>
<blockquote><p>“因为家里只有一台openwrt设备，无法使用PaoPaoDns&amp;&amp;PaoPaoGateway所以才这么做”。</p>
</blockquote>
<hr>
<p><strong>本文主讲基于Hyper-V虚拟机下，旁路由模式进行PaoPaoDns&amp;&amp;PaoPaoGateway的安装设置。</strong></p>
<h2>网络拓扑&amp;原理</h2>
<p><figure style="flex: 82.94573643410853" ><img loading="lazy" width="642" height="387" src="https://github.com/lesnolie/Marverick/assets/81410185/9bd72574-0a42-445e-aa06-8e6c61c7970f" /><figcaption>paopaodns&&paopaogateway官方示例</figcaption></figure></p>
<p><strong>优势：</strong></p>
<ul>
<li>直连直接走主路由，只有代理才走网关。也就是说，即使paopaodns&amp;&amp;paopaogateway都坏了，旁路由崩溃了，因为有备用DNS的存在，你整个家庭网络系统仍然可以正常运行。</li>
<li>PaoPaoGateway 不需要硬盘</li>
</ul>
<p><figure style="flex: 50.16181229773463" ><img loading="lazy" width="620" height="618" src="https://github.com/lesnolie/Marverick/assets/81410185/81736437-1f01-4558-a875-6bae920c31f1" /><figcaption>本人理解的拓扑——direct</figcaption></figure></p>
<p><figure style="flex: 50.4071661237785" ><img loading="lazy" width="619" height="614" src="https://github.com/lesnolie/Marverick/assets/81410185/3164a5d3-35e8-48fc-8740-71cad1df6310" /><figcaption>本人理解的拓扑——prxoy</figcaption></figure></p>
<p>而普通的openwrt，无论直连和代理，都需要走一遍openwrt，所以，速度不言而喻。</p>
<p><figure style="flex: 40.2672718103883" ><img loading="lazy" width="1597" height="1983" src="https://github.com/lesnolie/Marverick/assets/81410185/34e73d52-d1e7-4201-b3e0-93a068bfde9e" /><figcaption>其他拓扑解析</figcaption></figure></p>
<h2>安装PaoPaoDns</h2>
<p><strong><em>基于Apline-linux安装，因为他小巧易用。</em></strong></p>
<h3>一、安装 Alpine Linux</h3>
<p>1.1. 前往 <a href="https://www.alpinelinux.org/downloads/">Alpine 官网</a>下载安装镜像，这里选用 Virtual 镜像（只有小小的30M+），安装完系统空间占用大概 132MB 左右；
1.2. 使用上述镜像创建一台 Hyper-V 二代虚拟机（记得关闭安全启动），并启动；
1.3. 因为Alpine刚装完是只读状态，一定要进行设置，否则重启就还原。（我在这里纠结了一下午）
<strong><em>示例设置流程</em></strong></p>

<pre><code># 使用 root 超级用户直接登录
localhost login: root
# 运行 setup-alpine 安装程序
localhost:~# setup-alpine
# 询问键盘布局设置，直接输入 cn ，并回车
Select keyboard layout [none]: cn
# 询问字符集设置，直接输入 cn ，并回车
Select variant []: cn
# 询问主机名设置，如无特殊需要直接回车即可（仅能由小写英文字母及英文横杠组成）
Enter system hostname (short form, e.g. 'foo') [localhost]: 
# 选择将用于外网连接的网卡，如无特殊需，求直接回车使用默认的 eth0 即可
Which one do you want to initialize? (or '?' or 'done') [eth0]
# 询问主机 IP 获取方式，如无特殊需求，直接回车使用默认的 DHCP 获取方式即可
Ip address for eth0? (or 'dhcp', 'none', '?') [dhcp] 
# 询问是否需要手动配置其它特殊的网络设置，无特殊需求直接回车，默认“否”即可
Do you want to do any manual network configuration? [no]
# 设置 root 超级用户密码（需重复一遍，不能是弱密码，位数要求高于六位，为了安全设置时不显示任何字符）
Changing password for root
New password: 
Retype password: 
# 询问时区设置，直接输入 Asia/Shanghai 并回车即可
Which timezone are you in? ('?' for list) [UTC] Asia/Shanghai
# 询问是否设置 HTTP/FTP 代理，无特殊需求直接回车不配置即可
HTTP/FTP proxy URL? (e.g. 'http://proxy:8080', or 'none') [none]
# 询问软件包镜像源配置，国内的推荐选择域名后缀为 edu.cn 的其中一个，根据自己的网络来选
Enter mirror number (1-44) or URL to add (or r/f/e/done) [f]: 23
# 询问使用哪个 SSH server 程序，无特殊需求直接回车使用默认的 openssh 即可
Which SSH server? ('openssh', 'dropbear' or 'none') [openssh] 
# 询问使用哪个 NTP client 时间同步校对客户端，无特殊需求直接回车使用默认的 chrony 即可
Which NTP client to run? ('busybox', 'openntpd', 'chrony' or 'none') [chrony] 
# 询问将哪块硬盘用于配置 Alpine Linux 环境，根据自己需求输入对应硬盘并回车即可
Which disk(s) would you like to use? (or '?' for help or 'none') [none] sda
# 询问上面选择的硬盘用途，直接输入 sys 并回车用于安装 Alpine Linux 系统即可
How would you like to use it? ('sys', 'data', 'lvm' or '?' for help) [?] sys
# 告知将格式化整块磁盘，询问是否继续，输入 y 并回车选择“是”继续即可
WARNING: Erase the above disk(s) and continue? [y/N]: y

# 之后就是等待安装完成提示重启即可（记得提前弹出CD-ROM/DVD）
reboot</code></pre>
<p>注：弹出CD-ROM/DVD需要在HYPER-V，Alpine的设置处弹出，这里不再进行截图，请自行寻找。</p>
<p>1.4. 设置网络：setup-interfaces，设置IP，这个IP就是以后你的DNS的IP。<strong>比如我设置的是192.168.50.2</strong></p>
<h3>二、安装docker</h3>
<p>有一个<a href="https://gist.github.com/rupertbenbrook/99a02725934f91a280d154800d541634">Alpine的脚本</a>，但是这个脚本我直接运行总是没效果，所以我就把脚本里面的所有命令手打了一遍，效果拔群，你们也可以试试。</p>
<h3>三、安装PaoPaoDns</h3>
<p><strong><em>如果你的网络环境访问Dokcer镜像有困难，可以尝试使用<a href="https://mirror.sjtu.edu.cn/docs/docker-registry">上海交大</a>的镜像。</em></strong><br>
官方建议使用docker-compose进行安装，方便更新以及更新配置：</p>
<h1>修改 192.168.50.3 为你自己的网关(你准备设置的PaoPaoGateway)地址，其他无需修改</h1>

<pre><code>version: "3"

services:
  paopaodns:
    image: sliamb/paopaodns:latest
    container_name: PaoPaoDNS
    restart: always
    volumes:
      - /home/paopaodns:/data
    environment:
      - TZ=Asia/Shanghai
      - UPDATE=weekly
      - DNS_SERVERNAME=PaoPaoDNS,blog.03k.org
      - DNSPORT=53
      - CNAUTO=yes
      - CNFALL=yes
      - CN_TRACKER=yes
      - USE_HOSTS=no
      - IPV6=no
      - SOCKS5=192.168.50.3:1080
      - SERVER_IP=10.10.10.8
      - CUSTOM_FORWARD=192.168.50.3:53
      - AUTO_FORWARD=yes
      - AUTO_FORWARD_CHECK=yes
      - USE_MARK_DATA=yes
      - HTTP_FILE=yes
    ports:
      - "53:53/udp"
      - "53:53/tcp"
      - "5304:5304/udp"
      - "5304:5304/tcp"
      - "7889:7889/tcp"</code></pre>
<p>当然，你也可以直接使用docker进行安装（我就是这样）</p>

<pre><code>#拉取最新的docker镜像
docker pull sliamb/paopaodns:latest
#设置环境变量
#修改 192.168.50.3 为你自己的网关(你准备设置的PaoPaoGateway)地址，其他无需修改
docker run -d \
--name paopaodns \
-v /home/mydata:/data \
-e UPDATE=weekly \
-e CNAUTO=yes \
-e CNFALL=yes \
-e CN_TRACKER=yes \
-e IPV6=no \
-e CUSTOM_FORWARD=192.168.50.3:53  \
-e  AUTO_FORWARD=yes   \
-e  AUTO_FORWARD_CHECK=yes \
-e  USE_MARK_DATA=yes \
-e  CN_TRACKER=yes \
-e  ADDINFO=yes \
-e  SHUFFLE=yes \
-e  RULES_TTL=604800 \
-e  TZ=Asia/Shanghai \
--restart unless-stopped \
-p 53:53/tcp -p 53:53/udp \
-p 5304:5304/tcp -p 5304:5304/udp \
sliamb/paopaodns</code></pre>
<h3>四、安装备用DNS</h3>
<p>你可以再安装一个PaoPaodns作为备用dns，当其中一个崩溃时另一个仍能运行。
并且听说ikuai必须设置两个dns。
不知道能不能在远程运行一个PaoPaoDns作为备用Dns服务器，你可以试试，我觉得可行。....</p>
<h3>五、安装PaoPaoGateway</h3>
<p>随便找一个能运行docker的机器，刚才Alpine就可以。</p>
<p>创建目录</p>

<pre><code>mkdir iso</code></pre>
<p>进入目录</p>

<pre><code>cd iso</code></pre>
<p>5.1.1 network.ini配置</p>

<pre><code>ip=192.168.50.3
mask=255.255.255.0
gw=192.168.50.1
dns1=192.168.50.2
dns2=备用DNS</code></pre>
<p>参数解释：</p>
<blockquote><p>ip：PaoPaoGateWay的IP要和PaoPaoDNS的-e CUSTOM_FORWARD=192.168.50.3:53一致。
   gw：主路由的IP.
   dns1:PaoPaoDNS（主）的IP
   dns2:PaoPaoDNS（备）的IP</p>
</blockquote>
<p>5.1.2 ppgw.ini配置
下面参数根据实际修改。</p>
<p>主要参数：</p>
<blockquote><p>clash_web_password="password" # 管理面板的密码password
   dns_ip=192.168.50.2 # PaoDNS（主）
   ex_dns="192.168.50.2:53" # PaoDNS（主）
   model建议使用yaml，因为clash的proxies比较容易写。</p>
</blockquote>
<p>配置如下</p>

<pre><code>#paopao-gateway

# mode=socks5|ovpn|yaml|suburl|free
# default: socks5
mode=yaml

# Set fakeip's CIDR here
# default: fake_cidr=7.0.0.0/8
fake_cidr=11.0.0.0/8

# Set your trusted DNS here
# default: dns_ip=1.0.0.1
# 使用PaoPaoDNS这里就设置PaoDNS的地址
dns_ip=192.168.50.2
# default: dns_port=53
# If used with PaoPaoDNS, you can set the 5304 port
dns_port=5304

# Clash's web dashboard
clash_web_port="80"
# Clash's 面板密码
clash_web_password="password"

# default:openport=no
# socks+http mixed 1080
openport=yes

# default: udp_enable=no
udp_enable=no

# default:30
sleeptime=30

# socks5 mode settting
# default: socks5_ip=gatewayIP
socks5_ip="192.168.8.1"
# default: socks5_port="7890"
socks5_port="7890"

# ovpn mode settting
# The ovpn file in the same directory as the ppgw.ini.
# default: ovpnfile=custom.ovpn
ovpnfile="custom.ovpn"
ovpn_username=""
ovpn_password=""

# yaml mode settting
# The yaml file in the same directory as the ppgw.ini.
# default: yamlfile=custom.yaml
yamlfile="custom.yaml"

# suburl mode settting
suburl=""
subtime=1d

# fast_node=check/yes/no
fast_node=yes
test_node_url="https://cp.cloudflare.com"
ext_node="Traffic|Expire| GB|Days|Date"
cpudelay="3000"

# dns burn setting
# depand on fast_node=yes &amp; mode=suburl/yaml
dns_burn=yes
# If used with PaoPaoDNS, you can set the PaoPaoDNS:53
ex_dns="192.168.50.2:53"</code></pre>
<p>5.1.3 custom.yaml配置(CLASH)
直接把你节点的proxies部分复制进来就行，但是注意复制后的格式哈。
下面是一个配置例子。</p>

<pre><code>proxies:
- name: "hysteria2"
  type: hysteria2
  server: server.com
  port: 443
  # ports: 10000-20000/443
  #  up和down均不写或为0则使用BBR流控
  # up: "30 Mbps" # 若不写单位，默认为 Mbps
  # down: "200 Mbps" # 若不写单位，默认为 Mbps
  password: yourpassword
  # obfs: salamander # 默认为空，如果填写则开启obfs，目前仅支持salamander
  # obfs-password: yourpassword
  # sni: server.com
  # skip-cert-verify: false
  # fingerprint: xxxx
  # alpn:
  #   - h3
  # ca: "./my.ca"
  # ca-str: "xyz"</code></pre>
<blockquote><p>yaml：自定义clash的yaml配置文件出站。你可以自己写一个clash格式的yaml配置文件，clash支持多种出站协议，具体写法请看官方wiki。只写proxies:字段即可，也可以包含rules:字段。如果只有proxies:字段，在网关启动后你可以在web端选择节点；如果有rules:字段，则会按照你写的规则来执行。
5.2 网关的编译</p>
</blockquote>
<p>替换clash/mihomo核心
你可以把你的amd64的clash/mihomo(就是clash-meta)二进制文件重命名为clash放到当前目录即可。通过替换clash核心，你可以支持更多的协议和规则功能，比如替换为<a href="https://github.com/MetaCubeX/mihomo/releases">mihomo</a>。</p>
<p>最终你的iso文件夹会是这个样子的:</p>
<p><figure style="flex: 207.08661417322836" ><img loading="lazy" width="526" height="127" src="https://github.com/lesnolie/Marverick/assets/81410185/5d39771c-87f1-4968-9d43-d4cf966441a9" /><figcaption>iso文件夹</figcaption></figure></p>
<p>在iso文件夹下执行这个命令</p>

<pre><code>docker run --rm -v .:/data sliamb/ppgwiso</code></pre>
<p>等待执行完成，你的PaoPaoGateWay就会出现在文件夹下了。
下载。</p>
<h3>六、创建PaoPaoGateway虚拟机</h3>
<h4>运行要求和配置下发</h4>
<table>
<thead><tr>
<th>类型</th>
<th>要求</th>
</tr>
</thead>
<tbody>
<tr>
<td>虚拟机CPU</td>
<td>x86-64</td>
</tr>
<tr>
<td>内存</td>
<td>最低128MB，推荐256MB</td>
</tr>
<tr>
<td>硬盘</td>
<td>不需要</td>
</tr>
<tr>
<td>网卡</td>
<td>1</td>
</tr>
<tr>
<td>光驱</td>
<td>1  </td>
</tr>
</tbody>
</table>
<p><em>注意：如果节点数量很多或者连接数很多或者你的配置文件比较复杂的话，建议适当增加内存和CPU核心数</em></p>
<p>在hyper-新建虚拟机，<strong>选择第一代</strong>（重点），最后一步无需使用磁盘，完成后虚拟机设置加载刚才打包的 ISO镜像，直接光驱启动即可。</p>
<p>登录面板，地址为：网关IP地址/ui</p>
<p><figure style="flex: 85.4521625163827" ><img loading="lazy" width="1304" height="763" src="https://github.com/lesnolie/Marverick/assets/81410185/78126142-0d89-48bb-936a-79e41fec2a3e" /><figcaption>登录面板</figcaption></figure></p>
<h3>附我的hyper-v截图</h3>
<p><figure style="flex: 325.187969924812" ><img loading="lazy" width="865" height="133" src="https://github.com/lesnolie/Marverick/assets/81410185/52ee282b-d10b-4c89-8ab4-b12227c15fa9" /><figcaption>hyper-v截图</figcaption></figure></p>
<h3>七、主路由设置</h3>
<p>需要设置一下内容：我的主路由是梅林固件，你按照你的配置</p>
<p>7.1 LAN-DHCP
<figure style="flex: 61.57232704402516" ><img loading="lazy" width="979" height="795" src="https://github.com/lesnolie/Marverick/assets/81410185/01806c1a-5cd1-4c35-9b7d-0a4587461ef1" /><figcaption>LAN-DHCP</figcaption></figure></p>
<p>7.2 静态路由设置</p>
<p><figure style="flex: 56.84931506849315" ><img loading="lazy" width="996" height="876" src="https://github.com/lesnolie/Marverick/assets/81410185/23ee96ec-61e7-4cf2-94ef-346275b40556" /><figcaption>静态路由设置</figcaption></figure></p>
<hr>
<h3>结语</h3>
<p>看起来麻烦，实际特别简单</p>
<ul>
<li>安装Alpine</li>
<li>Alpine安装docker</li>
<li>安装PaoPaodns</li>
<li>编译PaoPaoGateway</li>
<li>启用PaoPaoGateway</li>
</ul>
<p><a href="https://github.com/lesnolie/Marverick/issues/37">Hyper-V下PaoPaoDns&amp;&amp;PaoPaoGateway配置教程</a></p>

            </div>
        </div>
    </article>
</div>


<div class="next-post">
 
    <div class="next"">下一篇</div>
    <a href="/archives/这可能是我用过的最好用的背景去除工具——tools篇一：PIXIAN.AI/">

        <h3 class="post-title">
            这可能是我用过的最好用的背景去除工具——tools篇一：PIXIAN.AI
        </h3>
    </a>
 
</div>




           

        
        
        <div class="site-footer">
          · <a href="https://github.com/AlanDecode/Maverick">Maverick</a> ·
          Mincho ·<a class="rss" href="/feed/index.xml" target="_blank">
          RSS
        </a>
        </div>
      </div>
    </div>



<script>
    (function(){
        var wrap = function(el, wrapper) {
            el.parentNode.insertBefore(wrapper, el);
            wrapper.appendChild(el);
        }
        // Parse iframes
        var iframes = document.querySelectorAll('.post-content iframe');
        for (var index = 0; index < iframes.length; index++) {
            var el = iframes[index],
                width = parseInt(el.getAttribute('width') || 16),
                height = parseInt(el.getAttribute('height') || 9);
            var padding = String(100*height/width) + '%';

            var wrapper1 = document.createElement('div');
            wrapper1.classList.add('iframe-wrapper-inner');
            wrapper1.style.paddingTop = padding;

            var wrapper2 = document.createElement('figure');
            wrapper2.classList.add('iframe-wrapper');

            wrap(el, wrapper1);
            wrap(wrapper1, wrapper2);
        }
    })();
</script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
<script>
(function (gallerySelector, itemSelector) {
    var openPhotoSwipe = function (galleryIndex, itemIndex) {
        var gallery = this.gallerys[galleryIndex];
        var options = {
            galleryUID: String(galleryIndex + 1),
            index: itemIndex,
            getThumbBoundsFn: function (index) {
                var thumbnail = gallery[index].el,
                    pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                    rect = thumbnail.getBoundingClientRect();
                return { x: rect.left, y: rect.top + pageYScroll, w: rect.width };
            }
        }
        var pswp = new PhotoSwipe(document.querySelectorAll('.pswp')[0],
            PhotoSwipeUI_Default, gallery, options);
        pswp.init();
    };

    var figureClick = function (e) {
        e = e || window.event;
        e.preventDefault ? e.preventDefault() : e.returnValue = false;
        var eTarget = e.target || e.srcElement;  // figure

        // 找到最近的 item
        var figure = eTarget;
        while (!figure.matches(itemSelector)) {
            figure = figure.parentNode;
        }

        // 找到最近的 gallery
        var gallery = figure;
        while (!gallery.matches(gallerySelector)) {
            gallery = gallery.parentNode;
        }

        var galleryIndex = parseInt(gallery.dataset.pswpGid) - 1;
        var itemIndex = parseInt(figure.dataset.pswpPid) - 1;
        openPhotoSwipe(galleryIndex, itemIndex);
    }

    var initPhotoSwipeFromDOM = function () {
        this.gallerys = [];

        var gallyers = document.querySelectorAll(gallerySelector);
        for (var i = 0; i < gallyers.length; i++) {
            var gallery = gallyers[i];
            gallery.setAttribute('data-pswp-gid', i + 1);
            var currentList = []

            var figures = gallery.querySelectorAll(itemSelector);
            for (var j = 0; j < figures.length; j++) {
                var figure = figures[j];
                figure.setAttribute('data-pswp-pid', j + 1);
                figure.onclick = figureClick;
                img = figure.firstChild;
                currentList.push({
                    src: img.src,
                    h: parseInt(img.getAttribute('height')),
                    w: parseInt(img.getAttribute('width')),
                    el: img
                })
            }

            this.gallerys.push(currentList);
        }
    }

    // parse picture index and gallery index from URL (#&pid=1&gid=2)
    var photoswipeParseHash = function () {
        var hash = window.location.hash.substring(1),
            params = {};

        if (hash.length < 5) {
            return params;
        }

        var vars = hash.split('&');
        for (var i = 0; i < vars.length; i++) {
            if (!vars[i]) {
                continue;
            }
            var pair = vars[i].split('=');
            if (pair.length < 2) {
                continue;
            }
            params[pair[0]] = pair[1];
        }

        if (params.gid) {
            params.gid = parseInt(params.gid, 10);
        }

        return params;
    };

    var openFromUrl = function () {
        var hashData = photoswipeParseHash();
        if (hashData.gid && hashData.pid) {
            openPhotoSwipe(hashData.gid - 1, hashData.pid - 1);
        }
    }

    initPhotoSwipeFromDOM();
    openFromUrl();
})('.pswp-gallery', '.pswp-item');
</script>



<!--katex-->
    <script defer src="/assets/katex.min.js"></script>
    <script>
    mathOpts = {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\[", right: "\\]", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\(", right: "\\)", display: false}
        ]
    };
    </script>
    <script defer src="/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>
    

    <script src="/assets/ExSearch/jquery.min.js"></script>
    <script src="/assets/ExSearch/ExSearch-493cb9cd89.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      (function () {
        var domain = document.domain;
        var els = document.getElementsByTagName('a');
        for (var index = 0; index < els.length; index++) {
          var element = els[index];
          var target = element.getAttribute('target');
          if (typeof target === 'undefined' || (target != '' && target != '_self')) {
            if (element.hostname != domain) {
              element.setAttribute('target', '_blank');
            }
          }
        }
      })(); 
    });
  </script>

    </body>
</html>